#import the neccesary functions to encrypt the message
from findPrime import findPrime
from n import n
from carmichael import carmichael
from findE import findE
from extEuclidAlgo import findx
from message import message
from binExp import binExp
from decrypt import decrypt
import sys
sys.setrecursionlimit(10000)
# Find the 2 prime numbers
p,q = findPrime()
p = int(p)
q = int(q)
print(f'p is{p},q is {q}')
#p,q = 1118760969414109910093206180573937539949670613819297699490877205319444113008626613467996584146146532957123076501261518468345038858638842888878343929361351003893883083768913382397872197378671908937667758692709382060854837826467591206533627273988077764120531290473449763367835211474288746889839091203332752935681890478149135894090125382159447109209098116049158828571036489876609862161063616474359760580469836604787824204496847236522342794237378935160788273693234941095636860717412796143854080960863625760008816588234051130292291804875290230237366029137020850811321069643706145632137800409823481489078797, 1217775368611911117116774876715469544059203238980227678691004984293820921940490877663506901787106062243037087790841022183739626697193434948970207418681625142121870206273700839416199085342309345295701821387079209876038300657388028288830183144376782895058998062479324789138962815524315747814215055111449746002505938736660464742390882017914266658219980556986897693807709826978915141666516988789458325535444818278546890536612474805857388347106795249106713018376406670780332908199208787716431137581021155293549771152340840432682680735164446763456500348498816634522672444737981279536376190609929037929395093
# Multiply them together 
N = n(p,q)
print(f'N is {N}')
# find the carmicheal value
lamN = carmichael(p,q)
print(f'lamN is{lamN}')
# find E
e = findE(lamN)
print(f'e is {e}')
# find d 
d = findx(e,lamN)
print(f'd is {d}')
# obtain the message that will be encrypted
plaintext = int(message(input("enter: ")))
print(plaintext)
# encrpyt the message
cyphertext = binExp(plaintext,e,N)
print(f'the cyphertext is {cyphertext}')
# decrypt the message
decrypted = binExp(cyphertext,d,N)
# output the message
#convert from ASCII into the string
message = decrypt(decrypted)
print(message)
